syntax = "proto3";

import "google/protobuf/empty.proto";

package msg;

option go_package = "github.com/caldog20/go-overlay/msg";


message RegisterRequest {
  string hostname = 1;
  string port = 2;
}

message RegisterReply {
  string vpn_ip = 1;
  string uuid = 2;
}

message WhoIsIP {
  string vpn_ip = 1;
}

message WhoIsIPReply {
  string remote = 1;
}

message PunchSubscribe {
  string vpn_ip = 1;
}

message PunchNotification {
  string remote = 1;
}

message PunchRequest {
  string src_vpn_ip = 1;
  string dst_vpn_ip = 2;
}

service ControlService {
  rpc Register(RegisterRequest) returns (RegisterReply) {}
  rpc WhoIs(WhoIsIP) returns (WhoIsIPReply) {}
  rpc Punch(PunchRequest) returns (google.protobuf.Empty) {}
  rpc PunchNotifier(PunchSubscribe) returns (stream PunchNotification) {}
}
